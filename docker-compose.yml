version: "3"
services:
  ploneidg:
    image: unixelias/plone.idg:latest
    depends_on:
      - zeoserver
    environment:
      - ZEO_ADDRESS=zeoserver:8100
    deploy:
      replicas: 2
    ports:
      - 8080:8080
    command: chown -R 500:500 /data
    command: start

  zeoserver:
    hostname: 'zeoserver'
    image: unixelias/plone.idg:latest
    command: chown -R 500:500 /data
    command: zeoserver
    volumes:
      - plone-data:/data

volumes:
  plone-data:
    external: true
